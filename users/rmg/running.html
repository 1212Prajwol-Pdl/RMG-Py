
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>6. Running a Job &#8212; RMG-Py 2.4.1 Documentation</title>
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="7. Analyzing the Output Files" href="output.html" />
    <link rel="prev" title="5. Example Input Files" href="examples.html" />
<script type="text/x-mathjax-config">
MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
  MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
    ce: ["Extension","mhchem"],
  });
});
</script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="output.html" title="7. Analyzing the Output Files"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="examples.html" title="5. Example Input Files"
             accesskey="P">previous</a> |</li>
  <li><a href="http://rmg.mit.edu/">RMG</a> &raquo;</li>
  <li><a href="../../index.html">2.4.1 Documentation</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >User’s Guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">RMG User’s Guide</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="running-a-job">
<span id="running"></span><h1>6. Running a Job<a class="headerlink" href="#running-a-job" title="Permalink to this headline">¶</a></h1>
<p>Running a basic RMG job is straightforward. However, depending on your case you might want to add the flags outlined in the following examples.</p>
<p><strong>Note:</strong> In all these examples <code class="docutils literal notranslate"><span class="pre">rmg.py</span></code> should be the path to your installed RMG (eg. yours might be <code class="docutils literal notranslate"><span class="pre">/Users/joeblogs/Code/RMG-Py/rmg.py</span></code>) and <code class="docutils literal notranslate"><span class="pre">input.py</span></code> is the path to the input file you wish to run (eg. yours might be <code class="docutils literal notranslate"><span class="pre">RMG-runs/hexadiene/input.py</span></code>).  If you get an error like <code class="docutils literal notranslate"><span class="pre">python:</span> <span class="pre">can't</span> <span class="pre">open</span> <span class="pre">file</span> <span class="pre">'rmg.py':</span> <span class="pre">[Errno</span> <span class="pre">2]</span> <span class="pre">No</span> <span class="pre">such</span> <span class="pre">file</span> <span class="pre">or</span> <span class="pre">directory</span></code>  then probably the first of these is wrong. If you get an error like <code class="docutils literal notranslate"><span class="pre">IOError:</span> <span class="pre">[Errno</span> <span class="pre">2]</span> <span class="pre">No</span> <span class="pre">such</span> <span class="pre">file</span> <span class="pre">or</span> <span class="pre">directory:</span> <span class="pre">'/some/path/to/input.py'</span></code> then probably the second of these is wrong.</p>
<p>Basic run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">rmg</span><span class="o">.</span><span class="n">py</span> <span class="nb">input</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Run by restarting from a seed mechanism</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">rmg</span><span class="o">.</span><span class="n">py</span> <span class="nb">input</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">r</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">seed</span><span class="o">/</span>
</pre></div>
</div>
<p>Run with CPU profiling:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">rmg</span><span class="o">.</span><span class="n">py</span> <span class="nb">input</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">p</span>
</pre></div>
</div>
<p>We recommend you make a job-specific directory for each RMG simulation. Some jobs can take quite a while to complete, so we also recommend using a job scheduler if working in an linux environment.</p>
<p>The instructions below describe special cases for running an RMG job.</p>
<div class="section" id="running-rmg-in-parallel-with-slurm">
<h2>6.1. Running RMG in parallel with SLURM<a class="headerlink" href="#running-rmg-in-parallel-with-slurm" title="Permalink to this headline">¶</a></h2>
<p>RMG has the option to use multiple processes on one node for reaction generation and on-the-fly Quantum Mechanics Thermodynamic Property (QMTP) calculation. Here is an example submission script for an RMG-Py job with a SLURM scheduler.</p>
<p>The job reserves 24 tasks on a single node, but uses only 12 processes in parallel during
the RMG-Py simulation.</p>
<p>Make sure that:</p>
<ul class="simple">
<li><p>the queue named <code class="docutils literal notranslate"><span class="pre">debug</span></code> exists on your SLURM scheduler.</p></li>
<li><p>you modify the path to the parent folder of the RMG-Py installation folder.</p></li>
<li><p>you have an anaconda environment named <code class="docutils literal notranslate"><span class="pre">rmg_env</span></code> that contains RMG-Py’s dependencies.</p></li>
<li><p>the working directory from which you launched the job contains the RMG-Py input file <code class="docutils literal notranslate"><span class="pre">input.py</span></code></p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH -p debug</span>
<span class="c1">#SBATCH -J jobname</span>
<span class="c1">#SBATCH -n 24</span>

<span class="nv">Processes</span><span class="o">=</span><span class="m">12</span>
<span class="nv">RMG_WS</span><span class="o">=</span>/path/to/RMG/parent/folder
<span class="nb">export</span> <span class="nv">PYTHONPATH</span><span class="o">=</span><span class="nv">$PYTHONPATH</span>:<span class="nv">$RMG_WS</span>/RMG-Py/

<span class="nb">source</span> activate rmg_env

python <span class="nv">$RMG_WS</span>/RMG-Py/rmg.py -n <span class="nv">$Processes</span> input.py

<span class="nb">source</span> deactivate
</pre></div>
</div>
</div>
<div class="section" id="running-rmg-in-parallel-with-sge">
<h2>6.2. Running RMG in parallel with SGE<a class="headerlink" href="#running-rmg-in-parallel-with-sge" title="Permalink to this headline">¶</a></h2>
<p>RMG has the option to use multiple processes on one node for reaction generation and on-the-fly Quantum Mechanics Thermodynamic Property (QMTP) calculation. Here is an example submission script for an RMG-Py job with a SGE scheduler.</p>
<p>The job reserves 24 tasks on a single node, but uses only 12 processes in parallel during
the RMG-Py simulation.</p>
<p>Make sure that:</p>
<ul class="simple">
<li><p>the queue named <code class="docutils literal notranslate"><span class="pre">debug</span></code> exists on your SGE scheduler.</p></li>
<li><p>you modify the path to the parent folder of the RMG-Py installation
folder.</p></li>
<li><p>you have an anaconda environment named <code class="docutils literal notranslate"><span class="pre">rmg_env</span></code> that contains
RMG-Py’s dependencies.</p></li>
<li><p>the working directory from which you launched the job
contains the RMG-Py input file <code class="docutils literal notranslate"><span class="pre">input.py</span></code>.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /bin/bash</span>

<span class="c1">#$ -l debug</span>
<span class="c1">#$ -N jobname</span>
<span class="c1">#$ -pe singlenode 24</span>

<span class="nv">Processes</span><span class="o">=</span><span class="m">12</span>
<span class="nv">RMG_WS</span><span class="o">=</span>/path/to/RMG/parent/folder
<span class="nb">export</span> <span class="nv">PYTHONPATH</span><span class="o">=</span><span class="nv">$PYTHONPATH</span>:<span class="nv">$RMG_WS</span>/RMG-Py/

<span class="nb">source</span> activate rmg_env

python <span class="nv">$RMG_WS</span>/RMG-Py/rmg.py -n <span class="nv">$Processes</span> input.py

<span class="nb">source</span> deactivate
</pre></div>
</div>
</div>
<div class="section" id="details-on-the-implementation">
<h2>6.3. Details on the implementation<a class="headerlink" href="#details-on-the-implementation" title="Permalink to this headline">¶</a></h2>
<p>Currently, multiprocessing is implemented for reaction generation and the generation of QMfiles when using the QMTP option to compute thermodynamic properties of species. The processes are spawned and closed within each function. The number of processes is determined based on the ratio of currently available RAM and currently used RAM. The user can input the maximum number of allowed processes from the command line. For each reaction generation or QMTP call the number of processes will be the minimum value of either the number of allowed processes due to user input or the value obtained by the RAM ratio. The RAM limitation is employed, because multiprocessing is forking the base process and the memory limit (SWAP + RAM) might be exceeded when using too many processors for a base process large in memory.</p>
<p>In python 3.4 new forking contexts ‘spawn’ and ‘forkserver’ are available. These methods will create new processes which share nothing or limited state with the parent and all memory passing is explicit. Once RMG is transferred to python 3 it is recommended to use the spawn or forkserver forking context to potentially allow for an increased number of processes.</p>
</div>
</div>


          </div>
        </div>
      </div>
  <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
    <div class="sphinxsidebarwrapper">
        <div class="sidebarlogo"><a href="../../index.html">
            <img src="../../_static/rmg-logo-small.png" alt="RMG" />
        </a></div>
      <div id="sidebar">
        <div id="rmgsidebar">
          <a href="http://rmg.mit.edu">
            <div class="menuitem">
              <img src="../../_static/rmg-icon.png" class="icon" width="100%"/>
              <div class="menutext menutitle">RMG Website</div>
              <div class="menutext menudesc">Interactive website for RMG-Py</div>
            </div>
          </a>
          <a href="https://github.com/ReactionMechanismGenerator/RMG-Py">
            <div class="menuitem">
              <img src="../../_static/github-icon.png" class="icon" width="100%"/>
              <div class="menutext menutitle">RMG GitHub</div>
              <div class="menutext menudesc">View source and post issues</div>
            </div>
          </a>
        </div>
        <div class="menuitem">
  <h3><a href="../../contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">6. Running a Job</a><ul>
<li><a class="reference internal" href="#running-rmg-in-parallel-with-slurm">6.1. Running RMG in parallel with SLURM</a></li>
<li><a class="reference internal" href="#running-rmg-in-parallel-with-sge">6.2. Running RMG in parallel with SGE</a></li>
<li><a class="reference internal" href="#details-on-the-implementation">6.3. Details on the implementation</a></li>
</ul>
</li>
</ul>

        </div>
        <div class="menuitem">
  <h4>Previous topic</h4>
  <p class="topless"><a href="examples.html"
                        title="previous chapter">5. Example Input Files</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="output.html"
                        title="next chapter">7. Analyzing the Output Files</a></p>
        </div>
        <div class="menuitem">
<div role="note" aria-label="source link">
    <h3>This Page</h3>
        <ul class="this-page-menu">
            <li><a href="https://github.com/ReactionMechanismGenerator/RMG-Py/issues">Report A Bug</a></li>
            <li><a href="https://github.com/ReactionMechanismGenerator/RMG-Py/blob/master/documentation/source/users/rmg/running.rst"
                   rel="nofollow">View Source</a></li>
        </ul>
</div>
        </div>
        <div class="menuitem">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
    </div>
  </div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="output.html" title="7. Analyzing the Output Files"
             >next</a> |</li>
        <li class="right" >
          <a href="examples.html" title="5. Example Input Files"
             >previous</a> |</li>
  <li><a href="http://rmg.mit.edu/">RMG</a> &raquo;</li>
  <li><a href="../../index.html">2.4.1 Documentation</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >User’s Guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >RMG User’s Guide</a> &#187;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2002-2019, William H. Green, Richard H. West, and the RMG Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
    </div>
<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  try {
    var pageTracker = _gat._getTracker("UA-24556433-3");
    pageTracker._trackPageview();
  } catch(err) {}
</script>

  </body>
</html>