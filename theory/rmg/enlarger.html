
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>1. Rate-based Model Enlarging Algorithm &#8212; RMG-Py 2.1.0 Documentation</title>
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2. Prune Edge Species" href="prune.html" />
    <link rel="prev" title="RMG Theory Guide" href="index.html" />
<script type="text/x-mathjax-config">
MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
  MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
    ce: ["Extension","mhchem"],
  });
});
</script>

  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="prune.html" title="2. Prune Edge Species"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="RMG Theory Guide"
             accesskey="P">previous</a> |</li>
  <li><a href="http://rmg.mit.edu/">RMG</a> &raquo;</li>
  <li><a href="../../index.html">2.1.0 Documentation</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >Theory Guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">RMG Theory Guide</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="rate-based-model-enlarging-algorithm">
<span id="ratebasedmodelenlarger"></span><h1>1. Rate-based Model Enlarging Algorithm<a class="headerlink" href="#rate-based-model-enlarging-algorithm" title="Permalink to this headline">¶</a></h1>
<div class="figure">
<img alt="../../_images/fluxAlgorithm.png" src="../../_images/fluxAlgorithm.png" />
</div>
<p>To construct a mechanism, the user must specify an initial set of species and
the initial conditions (temperature, pressure, species concentrations, etc.).
RMG reacts the initial species in all possible ways according to its known
reaction families, and it integrates the model in time. RMG tracks the rate
(flux) at which each new “edge” species is produced, and species (and the
reactions producing them) that are produced with significant fluxes are
incorporated into the model (the “core”). These new core species are reacted
with all other core species in the model to generate a new set of edge species
and reactions. The time-integration restarts, and the expanded list of edge
species is monitored for significant species to be included in the core. The
process continues until all significant species and reactions have been
included in the model. The definition of a “significant” rate can be specified by the user
by taking the following definition for a single species rate:</p>
<p><span class="math">\(R_i = \frac{dC_i}{dt}\)</span></p>
<p>and the following definition for the reaction system’s characteristic rate, which is the sum of
all <strong>core</strong> species rates:</p>
<p><span class="math">\(R_{char} = \sqrt{\sum\limits_{j} R_{j}^2}\quad    \quad  \textrm{species $j$ $\in$  core}\)</span></p>
<p>When a <span class="math">\(\textrm{species $i$ $\in$ edge}\)</span>  exceeds a “significant” rate equal to <span class="math">\(\epsilon R_{char}\)</span>,
it is added to the core. The parameter <span class="math">\(\epsilon\)</span> is the user-specified
<code class="docutils literal"><span class="pre">toleranceMoveToCore</span></code> that can be adjusted under the <a class="reference internal" href="../../users/rmg/input.html#modeltolerances"><span class="std std-ref">model tolerances</span></a>
in the <a class="reference internal" href="../../users/rmg/input.html#input"><span class="std std-ref">RMG Input File</span></a>.</p>
<p>For more information on rate-based model enlargement, please refer to the papers <a class="reference internal" href="#gao2016" id="id1">[Gao2016]</a> or <a class="reference internal" href="#susnow1997" id="id2">[Susnow1997]</a>.</p>
<table class="docutils citation" frame="void" id="gao2016" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[Gao2016]</a></td><td>C. W. Gao, J. W. Allen, W. H. Green, R. H. West, “Reaction Mechanism Generator: automatic construction of chemical kinetic mechanisms.” <em>Computer Physics Communications</em> (2016).</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="susnow1997" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[Susnow1997]</a></td><td>R. G. Susnow, A. M. Dean, W. H. Green, P. K. Peczak, and L. J. Broadbelt. “Rate-Based Construction of Kinetic Models for Complex Systems.” <em>J. Phys. Chem. A</em> <strong>101</strong>, p. 3731-3740 (1997).</td></tr>
</tbody>
</table>
<div class="section" id="filtering-reactions-within-the-rate-based-algorithm">
<span id="filterreactionstheory"></span><h2>1.1. Filtering Reactions within the Rate-based Algorithm<a class="headerlink" href="#filtering-reactions-within-the-rate-based-algorithm" title="Permalink to this headline">¶</a></h2>
<p>Filtering reactions in the react step in the flux-based algorithm attempts to speed up model generation by attacking the pain point.  RMG has trouble
converging when generating models for large molecules because it searches for reactions on the order of <span class="math">\((n_{reaction\: sites})^{{n_{species}}}\)</span>.</p>
<p>The original algorithm performs in the following manner:</p>
<ol class="arabic simple">
<li>Reacts species together (slow)</li>
<li>Determines which reactions are negligible (fast)</li>
</ol>
<p>By filtering reactions we add a pre-filtering step before step 1 which prevents species from reacting together when the reactions are expected to be negligible
throughout the simulation.</p>
<div class="figure">
<img alt="../../_images/fluxAlgorithmWithReactionFiltering.png" src="../../_images/fluxAlgorithmWithReactionFiltering.png" />
</div>
<p>Here, <code class="docutils literal"><span class="pre">unimolecularThreshold</span></code> and <code class="docutils literal"><span class="pre">bimolecularThreshold</span></code> are binary arrays storing flag for whether a species or a pair of species are above a reaction threshold.
For a unimolecular rate, this threshold is set to <code class="docutils literal"><span class="pre">True</span></code> if the unimolecular rate of <span class="math">\(\textrm{reaction $k$}\)</span> for a species A</p>
<p><span class="math">\(R_{unimolecular} = k_{threshold}C_A &gt; \epsilon R_{char}\)</span></p>
<p>at any given time <span class="math">\(t\)</span> in the reaction system, where <span class="math">\(k_{threshold} = \frac{k_B T}{h}\)</span></p>
<p>For a bimolecular reaction occuring between species A and B, this threshold is set to <code class="docutils literal"><span class="pre">True</span></code> if the bimolecular rate</p>
<p><span class="math">\(R_{bimolecular} = k_{threshold}C_A C_B &gt; \epsilon R_{char}\)</span></p>
<p>at any given time <span class="math">\(t\)</span> in the reaction system, where <span class="math">\(k_{threshold} = 1 \times 10^{13} \frac{cm^3}{mol* s}\)</span> which is considered the diffusion limiting rate.</p>
<p>Two additional binary arrays <code class="docutils literal"><span class="pre">unimolecularReact</span></code> and <code class="docutils literal"><span class="pre">bimolecularReact</span></code> store flags for when the <code class="docutils literal"><span class="pre">unimolecularThreshold</span></code> or <code class="docutils literal"><span class="pre">bimolecularThreshold</span></code> flag
shifts from <code class="docutils literal"><span class="pre">False</span></code> to <code class="docutils literal"><span class="pre">True</span></code>.  RMG reacts species when the flag is set to <code class="docutils literal"><span class="pre">True</span></code>.</p>
</div>
</div>


          </div>
        </div>
      </div>
  <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
    <div class="sphinxsidebarwrapper">
        <div class="sidebarlogo"><a href="../../index.html">
            <img src="../../_static/rmg-logo-small.png" alt="RMG" />
        </a></div>
      <div id="sidebar">
        <div id="rmgsidebar">
          <a href="http://rmg.mit.edu">
            <div class="menuitem">
              <img src="../../_static/rmg-icon.png" class="icon" width="100%"/>
              <div class="menutext menutitle">RMG Website</div>
              <div class="menutext menudesc">Interactive website for RMG-Py</div>
            </div>
          </a>
          <a href="https://github.com/ReactionMechanismGenerator/RMG-Py">
            <div class="menuitem">
              <img src="../../_static/github-icon.png" class="icon" width="100%"/>
              <div class="menutext menutitle">RMG GitHub</div>
              <div class="menutext menudesc">View source and post issues</div>
            </div>
          </a>
        </div>
        <div class="menuitem">
  <h3><a href="../../contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">1. Rate-based Model Enlarging Algorithm</a><ul>
<li><a class="reference internal" href="#filtering-reactions-within-the-rate-based-algorithm">1.1. Filtering Reactions within the Rate-based Algorithm</a></li>
</ul>
</li>
</ul>

        </div>
        <div class="menuitem">
  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">RMG Theory Guide</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="prune.html"
                        title="next chapter">2. Prune Edge Species</a></p>
        </div>
        <div class="menuitem">
<div role="note" aria-label="source link">
    <h3>This Page</h3>
        <ul class="this-page-menu">
            <li><a href="https://github.com/ReactionMechanismGenerator/RMG-Py/issues">Report A Bug</a></li>
            <li><a href="https://github.com/ReactionMechanismGenerator/RMG-Py/blob/master/documentation/source/theory/rmg/enlarger.rst"
                   rel="nofollow">View Source</a></li>
        </ul>
</div>
        </div>
        <div class="menuitem">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
    </div>
  </div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="prune.html" title="2. Prune Edge Species"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="RMG Theory Guide"
             >previous</a> |</li>
  <li><a href="http://rmg.mit.edu/">RMG</a> &raquo;</li>
  <li><a href="../../index.html">2.1.0 Documentation</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >Theory Guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >RMG Theory Guide</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2002-2018, William H. Green, Richard H. West, and the RMG Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.
    </div>
  </body>
</html>